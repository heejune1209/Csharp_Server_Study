### ServerCore

1. Listener Class

```csharp
using System;
using System.Net;
using System.Net.Sockets;

namespace ServerCore
{
    class Listener
    {
        Socket _listenSoket;

        // Socket íƒ€ì…ì˜ ë§¤ê°œë³€ìˆ˜ë¥¼ ë°›ëŠ” ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬
		// í´ë¼ì´ì–¸íŠ¸ê°€ ì„œë²„ì— ì ‘ì†í–ˆì„ ë•Œ ì½œë°±í•˜ëŠ” í•¨ìˆ˜
        Action<Socket> _OnAcceptHandler;

        // listen ì†Œì¼“ ì´ˆê¸°í™”
        public void Init(IPEndPoint endPoint, Action<Socket> OnAcceptHandler)
        {
            // ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ë“±ë¡
            // ë‚˜ì¤‘ì— í´ë¼ì´ì–¸íŠ¸ê°€ ì—°ê²°ë˜ë©´ ì´ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ê² ë‹¤ê³  ë“±ë¡
            _OnAcceptHandler += OnAcceptHandler;
            // ì„œë²„ ì†Œì¼“ ìƒì„±
            _listenSoket = new Socket(endPoint.AddressFamily, SocketType.Stream, ProtocolType.Tcp);
            
            // ë¬¸ì§€ê¸° êµìœ¡
            // IP ë°”ì¸ë”© 
            _listenSoket.Bind(endPoint);

            // ì˜ì—… ì‹œì‘
            // Listen ì‹œì‘
            // backlog : ìµœëŒ€ ëŒ€ê¸°ìˆ˜
            _listenSoket.Listen(10); // ìµœëŒ€ ëŒ€ê¸° í

            // ì¼ë‹¨ í•œë²ˆ ìƒì„±í•˜ë©´ ê³„ì† ì¬ì‚¬ìš©ì´ ê°€ëŠ¥í•¨
            // SocketAsyncEventArgsë¥¼ í•œë²ˆ ìƒì„±í•˜ê³  ê³„ì† ì¬ì‚¬ìš©ì„ í•  ë•Œ ì£¼ì˜ì‚¬í•­
            // ê¸°ì¡´ì— ìˆë˜ ì”ì¬ë“¤ì„ ëª¨ë‘ ì‚­ì œí•´ì¤˜ì•¼ í•œë‹¤.
            SocketAsyncEventArgs args = new SocketAsyncEventArgs();
            
            // SocketAsyncEventArgsëŠ”
            // ë¹„ë™ê¸° ì†Œì¼“ ì‘ì—…(ì—°ê²°, ìˆ˜ì‹ , ì „ì†¡ ë“±)ì— í•„ìš”í•œ ëª¨ë“  ì •ë³´ì™€ ê²°ê³¼ë¥¼ ë‹´ê³ ,
            // ì‘ì—…ì´ ëë‚¬ì„ ë•Œ í˜¸ì¶œí•  ì½œë°±ê¹Œì§€ í¬í•¨í•œ â€˜ì‘ì—… ìš”ì²­ì„œâ€™ ê°ì²´ì•¼.
            // ì‰½ê²Œ ë§í•´ì„œ ìš´ì˜ì²´ì œì— ë¹„ë™ê¸° ë„¤íŠ¸ì›Œí¬ ìš”ì²­ì„ ë§¡ê¸¸ ë•Œ ì“°ëŠ” ìš”ì²­ì„œì´ë‹¤.
            // ì˜ˆë¥¼ ë“¤ì–´,[ìš”ì²­ì„œ ë‚´ìš©]
            // - ì–´ë–¤ ë°ì´í„°ë¥¼ ë³´ë‚´ê³  ì‹¶ì–´
            // - ì–´ëŠ ë²„í¼ì— ë°›ì•„ì¤˜
            // - ë‹¤ ëë‚˜ë©´ ëˆ„êµ¬í•œí…Œ ì•Œë ¤ì¤˜ (ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬)
            // ìš´ì˜ì²´ì œí•œí…Œ ìš”ì²­ì„œ í•˜ë‚˜ íˆ­ ë˜ì ¸ì£¼ê³ , ì¼ì´ ëë‚˜ë©´ OSê°€ ìš”ì²­ì„œì— ì íŒ ì½œë°± í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•´ì£¼ëŠ” êµ¬ì¡°.
            
            // ì£¼ìš” ì†ì„±ë“¤
            // - ì†ì„±                            ì„¤ëª…
            // - SetBuffer(byte[], int, int)	 ë°ì´í„°ë¥¼ ë³´ë‚¼/ë°›ì„ ë²„í¼ ì„¤ì •
            // - RemoteEndPoint	                 ì—°ê²°í•  ëŒ€ìƒ ì£¼ì†Œ (Connect ì‹œ ì‚¬ìš©)
            // - Completed	                     ğŸ’¬ ì‘ì—… ì™„ë£Œ ì‹œ í˜¸ì¶œë  ì½œë°± ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬
            // - SocketError	                 ê²°ê³¼: ì—ëŸ¬ê°€ ìˆì—ˆëŠ”ì§€?
            // - BytesTransferred	             ì‹¤ì œë¡œ ëª‡ ë°”ì´íŠ¸ê°€ ì „ì†¡/ìˆ˜ì‹ ë˜ì—ˆëŠ”ì§€
            // - BufferList	                     ë‹¤ì¤‘ ì „ì†¡ìš© ë²„í¼ ë¦¬ìŠ¤íŠ¸ (Send ì‹œ ì‚¬ìš©)
            // - UserToken	                     ë‚´ ë§˜ëŒ€ë¡œ ì“¸ ìˆ˜ ìˆëŠ” ë°ì´í„° (ì˜ˆ: ì„¸ì…˜ ì°¸ì¡°)

            // event callback ë°©ì‹ìœ¼ë¡œ ìš°ë¦¬ì—ê²Œ ë¬´ì—‡ì¸ê°€ë¥¼ ì „ë‹¬í•´ì¤Œ
            args.Completed += new EventHandler<SocketAsyncEventArgs>(OnAcceptCompleted);
            // í´ë¼ì´ì–¸íŠ¸ê°€ ì ‘ì†í•˜ë©´ í˜¸ì¶œë  ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ë¥¼ ë“±ë¡
            // AcceptAsync()ê°€ ëë‚¬ì„ ë•Œ ì‹¤í–‰ë  í•¨ìˆ˜ëŠ” ì—¬ê¸°ì„œ ì§€ì •í•œ OnAcceptCompleted

            // ì´ˆê¸°í™”ë¥¼ í•  ë•Œ ë“±ë¡ì„ ì‹ ì²­í•¨
            // ìµœì´ˆ AcceptAsync ë“±ë¡
            // ì´ì œ ì—°ê²° ëŒ€ê¸°ë¥¼ ì‹œì‘í•¨!
            RegisterAccept(args);
        }

        // ë“±ë¡ì„ ì˜ˆì•½
        private void RegisterAccept(SocketAsyncEventArgs args)
        {
            // ì´ë²¤íŠ¸ë¥¼ ì‚¬ìš©í•  ë•ŒëŠ” ë‹¤ì‹œ ì´ˆê¸°í™”ë¥¼ ì‹œí‚¨ ë‹¤ìŒì— ì‚¬ìš©í•´ì¤˜ì•¼ í•œë‹¤.
            // ì´ì „ì— ì‚¬ìš©ëœ ì†Œì¼“ì´ ìˆë‹¤ë©´ ì´ˆê¸°í™”
            args.AcceptSocket = null;

            // syncëŠ” ë™ê¸°, ì˜ì–´ì—ì„œ Aê°€ ë¶™ìœ¼ë©´ ë°˜ëŒ€ => AsyncëŠ” ë¹„ë™ê¸°
            // ë‹¹ì¥ ì™„ë£Œëœë‹¤ëŠ” ë³´ì¥ì€ ì—†ì§€ë§Œ ì¼ë‹¨ ìš”ì²­ì€ í•˜ê²Œ ë¨
            // ë§ ê·¸ëŒ€ë¡œ ë“±ë¡ì„ ì™„ë£Œí•¨
            // AcceptAsync bool íƒ€ì…ì„ return í•¨
            bool pending = _listenSoket.AcceptAsync(args);
            // ë¹„ë™ê¸°ë¡œ ì†ë‹˜ ê¸°ë‹¤ë¦¬ëŠ” ì¤‘
            // í´ë¼ì´ì–¸íŠ¸ ì—°ê²° ëŒ€ê¸° ì‹œì‘ (ë¹„ë™ê¸°)
            // í´ë¼ì´ì–¸íŠ¸ê°€ ì´ë¯¸ ëŒ€ê¸° ì¤‘ì´ë©´ pending == falseê°€ ë˜ê³  ì¦‰ì‹œ OnAcceptCompleted() ì‹¤í–‰
            // ì•„ë‹ˆë©´ args.Completed += ... ì´ë²¤íŠ¸ê°€ ë‚˜ì¤‘ì— í˜¸ì¶œë¨

            // pending == falseì˜ ì˜ë¯¸ : AcceptAsyncì„ í˜¸ì¶œí•˜ê¸°ëŠ” í–ˆì§€ë§Œ í• ì¼ì´ ì—†ì–´ì„œ ë°”ë¡œ ì™„ë£Œê°€ ëë‹¤ëŠ” ì˜ë¯¸
            // ìš”ì²­í•˜ëŠ” ë™ì‹œì— í´ë¼ì´ì–¸íŠ¸ê°€ ë°”ë¡œ ì ‘ì†ì„ í–ˆë‹¤ëŠ” ì˜ë¯¸, pending ì—†ì´ ì™„ë£Œ
            // ë¹„ìœ í•˜ìë©´, â€œì†ë‹˜ì´ ì´ë¯¸ ë¬¸ ì•ì— ëŒ€ê¸° ì¤‘ì´ì–´ì„œ, ë°”ë¡œ ì…ì¥ì‹œì¼œë„ ë˜ëŠ” ìƒí™©â€
            if (pending == false)
            {
                OnAcceptCompleted(null, args);
            }
            // pending == trueì˜ ì˜ë¯¸ : ë‚˜ì¤‘ì— êº¼ê¾¸ë¡œ ìš°ë¦¬ì—ê²Œ í†µë³´ê°€ ì˜´, SocketAsyncEventArgsì˜ ì´ë²¤íŠ¸ ì½œë°±ìœ¼ë¡œ ì „ë‹¬
            // âœ”ï¸ pending == trueì¼ ë•Œ
            // â€œì•„ì§ ì†ë‹˜ì´ ì•ˆ ì™€ì„œ, ì˜ˆì•½ ëª…ë‹¨ì— ì´ë²¤íŠ¸ ì½œë°±ìœ¼ë¡œ ë“±ë¡í•´ë‘ê³  ê¸°ë‹¤ë¦¬ëŠ” ìƒí™©â€          
            // ì„œë²„ëŠ” ì´ë²¤íŠ¸ë¥¼ args.Completed += ...ë¡œ ë“±ë¡í•´ë†“ê³             
            // í´ë¼ì´ì–¸íŠ¸ê°€ ë‚˜ì¤‘ì— ë“¤ì–´ì˜¤ë©´ â†’ ìë™ìœ¼ë¡œ OnAcceptCompleted()ê°€ í˜¸ì¶œë¨
            // ìë™ìœ¼ë¡œ args.Completed ì´ë²¤íŠ¸ ë°œìƒ â†’ ë“±ë¡ëœ í•¸ë“¤ëŸ¬ê°€ í˜¸ì¶œë¨
        }

        // í´ë¼ì´ì–¸íŠ¸ê°€ ì‹¤ì œë¡œ ì ‘ì†í–ˆì„ ë•Œ í˜¸ì¶œë¨
        private void OnAcceptCompleted(object sender, SocketAsyncEventArgs args)
        {
            // errorê°€ ì—†ì´ ì„±ê³µ
            if (args.SocketError == SocketError.Success)
            {
                // To do
                // í´ë¼ì´ì–¸íŠ¸ê°€ ì™”ì„ ë•Œ í•´ì•¼í•  ì¼ë“¤
                // => ì´ˆê¸°í™”ë¥¼ í•  ë•Œ ìš”ì²­ëœ ì‘ì—…ì„ ì‹¤í–‰í•˜ë©´ ëœë‹¤(ì—­ì‹œ ì´ë²¤íŠ¸ ì½œë°±ìœ¼ë¡œ ì²˜ë¦¬)
                _OnAcceptHandler.Invoke(args.AcceptSocket); // ë“±ë¡í•œ ì½œë°± ì‹¤í–‰!
                // ì—°ê²°ì´ ì„±ê³µí•˜ë©´ â†’ ë“±ë¡í•´ë‘” OnAcceptHandler ì½œë°± í˜¸ì¶œ
                // í´ë¼ì´ì–¸íŠ¸ ì†Œì¼“ì„ ì¸ìë¡œ ë„˜ê¹€
                // ì´í›„ ë‹¤ì‹œ RegisterAccept(args) í˜¸ì¶œí•´ì„œ ë‹¤ìŒ ì†ë‹˜ ëŒ€ê¸°
                // ì¦‰, ì„¸ì…˜ ìƒì„± or ë°ì´í„° ì²˜ë¦¬ ë‹´ë‹¹
            }
            else
            {
                System.Console.WriteLine(args.SocketError.ToString());
            }

            // ì—¬ê¸°ê¹Œì§€ ì˜¤ë©´ ëª¨ë“  ì¼ì´ ëë‚¬ìœ¼ë‹ˆê¹ ë‹¤ìŒ í´ë¼ì´ì–¸íŠ¸ë¥¼ ìœ„í•´ ë“±ë¡ì„ ì§„í–‰
            RegisterAccept(args);
        }
        // public Socket Accept()
        // {

        //     // // ì´ëŒ€ë¡œ ë‘ë©´ Blocking ê³„ì—´ì˜ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ìˆ˜ì •í•´ì•¼ í•œë‹¤.
        //     // // Acceptë¥¼ ë¬´ì‘ì • ê¸°ë‹¤ë ¤ì„œ ì²˜ë¦¬ê°€ ë˜ëŠ” ê²ƒì„ ë³´ì¥í•˜ëŠ” ë°©ì‹ì´ ì•„ë‹ˆê¸° ë•Œë¬¸ì— 
        //     // // ê²°êµ­ì—ëŠ” Acceptë¥¼ í•˜ê² ë‹¤ê³  ìš”ì²­í•˜ëŠ” ë¶€ë¶„ê³¼ ì²˜ë¦¬ í›„ ì™„ë£Œê°€ ë˜ëŠ” ë¶€ë¶„ì´ ì™„ì „íˆ ë¶„ë¦¬ì‹œí‚¨ë‹¤. => 2ë²ˆ ì‘ì—…
        //     return _listenSoket.Accept();
        // }

        // ìœ„ì˜ ì½”ë“œê°€ ë™ì‘ë˜ëŠ” íë¦„
        // listen ì†Œì¼“ ì´ˆê¸°í™” => RegisterAccept(Accept ëŒ€ê¸°)
        // Acceptê°€ ë°”ë¡œ ëë‹¤ë©´ => OnAcceptCompleted ì²˜ë¦¬ í›„ ì™„ë£Œ 
        // Acceptê°€ ë‚˜ì¤‘ì— ëë‹¤ë©´ => args.Completed ì½œë°± => OnAcceptCompleted ì‹¤í–‰

        // ì§ê´€ì ìœ¼ë¡œ íë¦„ì„ ì´í•´
        // ë‚šì‹œëŒ€ë¥¼ ë˜ì§„ë‹¤ : RegisterAccept()
        // ë¬¼ê³ ê¸°ê°€ ì¡í˜”ë‹¤ : OnAcceptCompleted()
        // ë‹¤ì‹œ ë‚šì‹œëŒ€ë¥¼ ë˜ì§„ë‹¤ : RegisterAccept()
        // ìœ„ íë¦„ì´ ê³„ì† ë°˜ë³µì´ ë¨
        
        // íë¦„ ìš”ì•½ ìˆœì„œ
        // â–¶ Listener.Init() í˜¸ì¶œ
           // â””â”€â–¶ ì†Œì¼“ ìƒì„± + ë°”ì¸ë”© + Listen
           // â””â”€â–¶ SocketAsyncEventArgs ê°ì²´ ìƒì„±
           // â””â”€â–¶ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ë“±ë¡ (args.Completed += OnAcceptCompleted)
           // â””â”€â–¶ RegisterAccept() â†’ AcceptAsync() ì‹œì‘

        // â–¶ í´ë¼ì´ì–¸íŠ¸ ì—°ê²° ë°œìƒ
        //    â””â”€â–¶ AcceptAsync ê²°ê³¼: pending == false â†’ ë°”ë¡œ OnAcceptCompleted() í˜¸ì¶œ
        //                       ë˜ëŠ”
        //                       pending == true â†’ ë‚˜ì¤‘ì— í´ë¼ ì ‘ì† ì‹œ OnAcceptCompleted() ìë™ í˜¸ì¶œ

        // â–¶ OnAcceptCompleted() ì‹¤í–‰
        //    â””â”€â–¶ _OnAcceptHandler.Invoke(clientSocket)
        //    â””â”€â–¶ ë‹¤ì‹œ RegisterAccept() â†’ ë‹¤ìŒ ì†ë‹˜ ëŒ€ê¸°
    }
}
```

1. ServerCoreProgram

```csharp
using System;
using System.Net;
using System.Net.Sockets;
using System.Text;

namespace ServerCore
{
    class ServerCoreProgram
    {
        static Listener _listener = new Listener();
        static void OnAcceptHandler(Socket clientSocket)
        {
            try
            {
                byte[] recvBuff = new byte[1024];

                int recvByte = clientSocket.Receive(recvBuff);

                string recvData = Encoding.UTF8.GetString(recvBuff, 0, recvByte);
                System.Console.WriteLine($"[From Client : {recvData}");

                byte[] sendBuff = Encoding.UTF8.GetBytes("Welcome to MMORPG Server!");
                clientSocket.Send(sendBuff);

                clientSocket.Shutdown(SocketShutdown.Both);
                clientSocket.Close();
            }
            catch (Exception e)
            {
                System.Console.WriteLine(e.ToString());
            }
        }
        static void Main(string[] args)
        {
            string host = Dns.GetHostName();

            IPHostEntry ipHost =  Dns.GetHostEntry(host);
            IPAddress ipAddr = ipHost.AddressList[0];
            IPEndPoint endPoint = new IPEndPoint(ipAddr, 7777);

            // ë¬¸ì§€ê¸°
            // â€œì´ IP/í¬íŠ¸ë¡œ ì†ë‹˜ ì˜¤ë©´ ë°›ì•„ì¤˜.
            // ëˆ„ê°€ ì˜¤ë©´ OnAcceptHandlerë¼ëŠ” í•¨ìˆ˜ë¡œ ì²˜ë¦¬í•´ì¤˜.â€
            _listener.Init(endPoint, OnAcceptHandler);
            System.Console.WriteLine("Listening...");

            // í”„ë¡œê·¸ë¨ì´ ì¢…ë£Œë˜ì§€ ì•Šë„ë¡ ì„ì‹œë¡ ë‚¨ê²¨ë‘ 
            while(true)
            {

            }
        }
    }
}
```

3. ë”ë¯¸ í´ë¼ì´ì–¸íŠ¸

```csharp
using System;
using System.Net;
using System.Net.Sockets;
using System.Text;
using System.Threading;

namespace DummyClient
{
    class Program
    {
        static void Main(string[] args)
        {
            // ì‹ë‹¹ì˜ ì£¼ì†Œë¥¼ ì°¾ëŠ” ê³¼ì •ì€ ë™ì¼í•¨
            string host = Dns.GetHostName();
            IPHostEntry ipHost = Dns.GetHostEntry(host);
            IPAddress ipAddr = ipHost.AddressList[0];
            IPEndPoint endPoint = new IPEndPoint(ipAddr, 7777);

            while(true)
            {
                // íœ´ëŒ€í° ì„¤ì •
                // ProtocolType.Tcpë¡œ ê²°ì •ì„ í•˜ë©´ SocketTypeë„ Streamìœ¼ë¡œ ìë™ìœ¼ë¡œ ê²°ì •ì´ ëœë‹¤.
                Socket socket = new Socket(endPoint.AddressFamily, SocketType.Stream, ProtocolType.Tcp);

                try
                {
                    // ë¬¸ì§€ê¸°í•œí…Œ ì…ì¥ ë¬¸ì˜ë¥¼ í•¨
                    // ìƒëŒ€ë°©ì˜ ì£¼ì†Œë¥¼ ë„£ì–´ì¤˜ì•¼í•¨
                    // ë¬¸ì§€ê¸°í•œí…Œ ì—°ë½ì´ ë‹¿ì„ ë•Œê¹Œì§€ ëŒ€ê¸°
                    socket.Connect(endPoint);

                    // ì„œë²„ì˜ ì •ë³´ë¥¼ ì¶œë ¥
                    // ì—°ê²°í•œ ëŒ€ìƒì˜ ì„œë²„ì˜ ì •ë³´
                    Console.WriteLine($"Connected to {socket.RemoteEndPoint.ToString()}"); // RemoteEndPointëŠ” ìš°ë¦¬ê°€ ì—°ê²°í•œ ë°˜ëŒ€ìª½ ëŒ€ìƒ

                    // ì„œë²„ë¡œ ë³´ë‚¸ë‹¤
                    byte[] sendBuff = Encoding.UTF8.GetBytes("Hello World!");
                    int sendByte = socket.Send(sendBuff);

                    // ì„œë²„ë¡œë¶€í„° ë°›ëŠ”ë‹¤
                    byte[] recvBuff = new byte[1024];
                    int recvBytes = socket.Receive(recvBuff);
                    string recvData = Encoding.UTF8.GetString(recvBuff, 0, recvBytes);
                    Console.WriteLine($"[From server] {recvData}");

                    // ë‚˜ê°„ë‹¤
                    socket.Shutdown(SocketShutdown.Both);
                    socket.Close();
                }
                catch (Exception e)
                {
                    Console.WriteLine(e.ToString());
                }

                Thread.Sleep(100); // 1ì´ˆ ëŒ€ê¸°
            }
        }
    }
}
```
