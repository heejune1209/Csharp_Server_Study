### ì˜ë¬¸ì 

```csharp
using System;
using System.Net;
using System.Net.Sockets;

namespace ServerCore
{
    class Listener
    {
        // ë¬¸ì§€ê¸°
        Socket _listenSoket;

        Action<Socket> _OnAcceptHandler;

        public void Init(IPEndPoint endPoint, Action<Socket> OnAcceptHandler)
        {
            _OnAcceptHandler += OnAcceptHandler;
            _listenSoket = new Socket(endPoint.AddressFamily, SocketType.Stream, ProtocolType.Tcp);

            _listenSoket.Bind(endPoint);

            // ì˜ì—… ì‹œì‘
            // BacklogëŠ” ìµœëŒ€ ëŒ€ê¸°ìˆ˜
            _listenSoket.Listen(10);

            // í˜„ì¬ ë¬¸ì§€ê¸°ë¥¼ í•œëª…ë§Œ ê³ ìš©ì„ í–ˆê¸° ë•Œë¬¸ì— 
            // ë„ˆë¬´ ë§ì€ ì‚¬ëŒì´ í•œë²ˆì— ì ‘ì†ì„ í•˜ë©´ ë‹¤ì†Œ ëŠë¦´ ìˆ˜ë„ ìˆë‹¤
            // í•´ì„œ ì´ ë¶€ë¶„ì„ ëŠ˜ë ¤ì£¼ë©´ ëœë‹¤.
            // ì´ë ‡ê²Œ ì§ì›ì„ ëŠ˜ë ¤ì£¼ë©´ ë¹„ë™ê¸°ë¡œ ì§ì›ë“¤ì´ Receive ì²˜ë¦¬ë¥¼ í•˜ê²Œ ëœë‹¤.
            // ë‚šì‹œëŒ€ë¥¼ ì—¬ëŸ¬ê°œë¡œ ë§Œë“¤ì–´ë„ ìƒê´€ì—†ìŒ
            for (int i = 0; i < 10; i++)
            {
                SocketAsyncEventArgs args = new SocketAsyncEventArgs();
                args.Completed += new EventHandler<SocketAsyncEventArgs>(OnAcceptCompleted);
                RegisterAccept(args);
            }
        }

        // ë“±ë¡ì„ ì˜ˆì•½
        private void RegisterAccept(SocketAsyncEventArgs args)
        {
            args.AcceptSocket = null;

            bool pending = _listenSoket.AcceptAsync(args);

            // ì˜ë¬¸ì 
            // ë§Œì¼ ê³„ì† pendingì´ falseê°€ ë˜ì–´ì„œ 
            // OnAcceptCompletedë¥¼ í˜¸ì¶œí•˜ê³  ë‹¤ì‹œ RegisterAcceptë¥¼ í˜¸ì¶œí•˜ëŠ” ì‹ìœ¼ë¡œ
            // ë¬´í•œ ë°˜ë³µì´ ë˜ë©´ ì–´ë–»ê²Œ ë ê¹Œ? => ì‹¤ì œë¡œ ë¬´í•œ ë°˜ë³µì´ ì¼ì–´ë‚˜ë©´ stack over flowê°€ ë°œìƒí•¨
            // ìš°ì„  Backlogë¥¼ 10ëª…ì„ ê±¸ì–´ë†”ì„œ í˜„ì‹¤ì ìœ¼ë¡œ ê³„ì† stack over flowê°€ ë°œìƒí•˜ì§€ ì•Šê³  
            // ê·¸ë¦¬ê³  pendingì´ ê³„ì† falseê°€ ë˜ëŠ” ìƒí™©ì€ í˜„ì‹¤ì ìœ¼ë¡œ ì˜ ì¼ì–´ë‚˜ì§€ëŠ” ì•ŠëŠ”ë‹¤.
            // ê·¸ë˜ë„ ìš°ë ¤ê°€ ë˜ë©´ ìˆ˜ì •ì„ í•˜ê¸´ í•´ì•¼ í•¨
            if (pending == false)
            {
                OnAcceptCompleted(null, args);
            }
        }

        private void OnAcceptCompleted(object sender, SocketAsyncEventArgs args)
        {
            if (args.SocketError == SocketError.Success)
            {
                _OnAcceptHandler.Invoke(args.AcceptSocket);
            }
            else
            {
                Console.WriteLine(args.SocketError.ToString());
            }

            RegisterAccept(args);
        }
    }
}
```

```csharp
using System;
using System.Net;
using System.Net.Sockets;
using System.Text;

namespace ServerCore
{
    class ServerCoreProgram
    {
        static Listener _listener = new Listener();
        static void OnAcceptHandler(Socket clientSocket)
        {
            try
            {
                byte[] recvBuff = new byte[1024];

                int recvByte = clientSocket.Receive(recvBuff);

                string recvData = Encoding.UTF8.GetString(recvBuff, 0, recvByte);
                System.Console.WriteLine($"[From Client : {recvData}");

                byte[] sendBuff = Encoding.UTF8.GetBytes("Welcome to MMORPG Server!");
                clientSocket.Send(sendBuff);

                clientSocket.Shutdown(SocketShutdown.Both);
                clientSocket.Close();
            }
            catch (Exception e)
            {
                System.Console.WriteLine(e.ToString());
            }
        }
        static void Main(string[] args)
        {
            string host = Dns.GetHostName();

            IPHostEntry ipHost = Dns.GetHostEntry(host);
            IPAddress ipAddr = ipHost.AddressList[0];
            IPEndPoint endPoint = new IPEndPoint(ipAddr, 7777);

            // ë¬¸ì§€ê¸° ë°°ì¹˜
            _listener.Init(endPoint, OnAcceptHandler);
            System.Console.WriteLine("Listening...");

            // í”„ë¡œê·¸ë¨ì´ ì¢…ë£Œë˜ì§€ ì•Šë„ë¡ ì„ì‹œë¡œ ë‚¨ê²¨ë‘ 
            // ì—¬ê¸°ì„œ ë©”ì¸ì“°ë ˆë“œëŠ” ë¬´í•œ ë°˜ë³µì„ ëŒê³  ìˆì§€ë§Œ
            // ì–´ë–»ê²Œ OnAcceptHandlerê°€ ì½œë°±í•¨ìˆ˜ê°€ ì‹¤í–‰ì´ ë˜ëŠ” ê±¸ê¹Œ?

            // AcceptAsync()ë¥¼ ì‹¤í–‰í•  ë•Œ SocketAsyncEventArgsë¥¼ ë„£ì–´ì£¼ë©´ 
            // ì½œë°± í•¨ìˆ˜ëŠ” ë‹¤ë¥¸ ìŠ¤ë ˆë“œ(ì“°ë ˆë“œ í’€)ì—ì„œ ì‹¤í–‰ì´ ë¨
            // âœ… ì´ ë§ì€ AcceptAsync()ëŠ” ë¹„ë™ê¸° í•¨ìˆ˜ë‹ˆê¹Œ,
            // ì—°ê²°ì´ ì™„ë£Œë˜ì—ˆì„ ë•Œ ìë™ìœ¼ë¡œ ì‹¤í–‰ë˜ëŠ” OnAcceptCompleted()ëŠ”
            // .NETì˜ ìŠ¤ë ˆë“œ í’€(ThreadPool) ì¤‘ í•˜ë‚˜ì—ì„œ ì‹¤í–‰ëœë‹¤ëŠ” ì˜ë¯¸ì•¼.
            // ì¦‰, ì´ í•¨ìˆ˜ëŠ” ë©”ì¸ ì“°ë ˆë“œì—ì„œ ì‹¤í–‰ë˜ëŠ” ê²Œ ì•„ë‹ˆë¼,
            // ë³„ë„ì˜ ìŠ¤ë ˆë“œì—ì„œ ì‹¤í–‰ë¨!

            // ê·¸ë ‡ë‹¤ëŠ” ê²ƒì€ OnAcceptCompletedì—ì„œ í˜¸ì¶œí•˜ëŠ” ë¶€ë¶„ê³¼ ë©”ì¸ì—ì„œ í˜¸ì¶œí•˜ëŠ” ë¶€ë¶„ì´ 
            // ë™ì‹œ ë‹¤ë°œì ìœ¼ë¡œ ê°™ì€ ë°ì´í„°ë¥¼ ê±´ë“œë¦°ë‹¤ê³  í•˜ë©´ ê²½í•© ì¡°ê±´ì´ ë°œìƒí•  ìˆ˜ ìˆë‹¤.
            //âœ… OnAcceptCompleted()ëŠ” í´ë¼ì´ì–¸íŠ¸ê°€ ì—°ê²°ë  ë•Œë§ˆë‹¤ ì‹¤í–‰ë¨
            // â†’ ì´ ì•ˆì—ì„œ ì˜ˆë¥¼ ë“¤ë©´ ì–´ë–¤ ì„¸ì…˜ ë¦¬ìŠ¤íŠ¸, ì—°ê²° ìˆ˜, ë¡œê·¸, ê³µìœ  ë°ì´í„° ë“±ì„ ê±´ë“œë¦°ë‹¤ê³  í•´ë´
            // ğŸ’¥ ê·¼ë° ë©”ì¸ ì“°ë ˆë“œë„ ê°™ì€ ë°ì´í„°ë¥¼ ìˆ˜ì •í•˜ê±°ë‚˜ ì½ëŠ”ë‹¤ë©´?
            // ë‘ ìŠ¤ë ˆë“œê°€ ë™ì‹œì— ì ‘ê·¼í•˜ë©´ ê²½í•©(Race Condition) ì´ ìƒê¸°ê³ , ì˜ˆìƒì¹˜ ëª»í•œ ë²„ê·¸, ì¶©ëŒ, ì˜ëª»ëœ ê²°ê³¼ê°€ ë°œìƒí•  ìˆ˜ ìˆìŒ!
            
            // ë”°ë¼ì„œ Listenerì˜ OnAcceptCompletedë¥¼ ë ˆë“œì¡´ì´ë¼ ìƒê°í•˜ê³ 
            // ë©”ì¸ ì“°ë ˆë“œì™€ ê²½í•© ì¡°ê±´ì´ ë°œìƒí•˜ì§€ ì•Šë„ë¡ ê³ ë ¤í•´ì•¼ í•œë‹¤.
            // ì§€ê¸ˆê¹Œì§€ëŠ” OnAcceptCompletedê°€ ë”±íˆ ìê¸°ì˜ ì†Œì†ëœ ì• ë“¤ë§Œ ê±´ë“œë ¤ ìˆê¸° ë•Œë¬¸ì— ì•„ë¬´ëŸ°
            // ë¬¸ì œê°€ ì—†ì—ˆì§€ë§Œ ë‚˜ì¤‘ì— ì˜ˆë¥¼ ë“¤ì–´ ì•ìœ¼ë¡œ ReceiveAsync()ë¡œ ë©”ì‹œì§€ë¥¼ ë°›ê³ , SendAsync()ë¡œ ì‘ë‹µì„ ë³´ë‚´ê³ ,
            // ì—°ê²°ì„ ë¦¬ìŠ¤íŠ¸ì— ë“±ë¡í•˜ê³ , ì œê±°í•˜ê³ â€¦ ì´ëŸ° ì‘ì—…ë“¤ì„ ì—¬ëŸ¬ ìŠ¤ë ˆë“œì—ì„œ ë™ì‹œì— ìˆ˜í–‰í•  ìˆ˜ ìˆê²Œ ë˜ë©´,
            // ì•„ë‹ˆë©´ì€ ì¢€ ë” ë³µì¡í•œ í–‰ìœ„ë¥¼ í•œë‹¤ê³  í•˜ë©´ì€ ë©€í‹°ìŠ¤ë ˆë“œ í”„ë¡œê·¸ë˜ë°ì˜ ë³¸ê²©ì ì¸ ìœ„í—˜ì´ ë‚˜íƒ€ë‚˜ê¸° ì‹œì‘í•œë‹¤ëŠ” ì˜ë¯¸.
            // ë°˜ë“œì‹œ ë½ì„ ê±¸ë˜ ì•„ë‹ˆë©´ ê·¸ëŸ° ë©€í‹°ìŠ¤ë ˆë“œì—ì„œ ì¼ì–´ë‚  ìˆ˜ ìˆëŠ” ë™ê¸°í™”
            // ë¬¸ì œë¥¼ ë°˜ë“œì‹œ í•´ê²°í•˜ë©´ì„œ ì½”ë”©ì„ í•´ì•¼ ëœë‹¤ëŠ” ì–˜ê¸°ê°€ ë˜ê² ìŠµë‹ˆë‹¤
            
            // ë©”ì¸ ì“°ë ˆë“œê°€ êº¼ì§€ì§€ ì•Šê²Œ ìœ ì§€
            while (true)
            {

            }
        }
    }
}
```
ì´ë²ˆ ì‹œê°„ì€ ë¦¬ì‹œë¸Œ í•˜ëŠ” ë¶€ë¶„ì„ ë”°ë¡œ ë¹¼ì£¼ëŠ” ì‘ì—…ì„ í•´ë³¼ê²ƒì„.

### Send Session

Sessionì´ ê¸°ë³¸ì ìœ¼ë¡œ í•˜ëŠ” ì—­í• ì„

í´ë¼ë¡œë¶€í„° íŒ¨í‚·ì„ ë³´ë‚´ëŠ” ê²ƒê³¼

í´ë¼ë¡œë¶€í„° íŒ¨í‚·ì„ ë°›ëŠ” ê²ƒì„ ë‹´ë‹¹í•˜ê²Œ ë¨

â‡’ ë”°ë¼ì„œ ì„¸ì…˜ì´ ìƒì„±ë˜ëŠ” ì‹œì ì€ Accept()ê°€ ì„±ê³µí•˜ê³  ë‚œ ë‹¤ìŒ

**[ì„¤ëª… ì¶”ê°€]**

```csharp
using System;
using System.Net.Sockets;
using System.Text;
using System.Threading;

namespace ServerCore
{
    class Session
    {
        Socket _socket;
        int _disconnected = 0;
        public void Start(Socket socket)
        {
            _socket = socket;
            SocketAsyncEventArgs recvArgs = new SocketAsyncEventArgs();
            recvArgs.Completed += new EventHandler<SocketAsyncEventArgs>(OnRecvComplected);

            // ìœ ì €ì— ëŒ€í•œ ì •ë³´ë¥¼ ì•„ë¬´ê±°ë‚˜ ì „ë‹¬í•´ì¤˜ë„ ëœë‹¤. => ì‹ë³„ìë¡œ êµ¬ë¶„í•˜ê³  ì‹¶ê±°ë‚˜ ì—°ë™í•˜ê³  ì‹¶ì„ ë•Œ ì‚¬ìš©
            // recvArgs.UserToken = 1; // ì•„ë‹ˆë©´ ì´ ì„¸ì…˜ì—ì„œ ì˜¨ ì• ë¼ëŠ” ëœ»ìœ¼ë¡œ thisë¥¼ ë„£ì–´ì¤˜ë„ ëœë‹¤.
            // ì´ê±´ Listener ì „ìš©ì¼ ë•Œ ì‚¬ìš©
            // recvArgs.AcceptSocket

            // recvë¥¼ í•  ë•Œ bufferë¥¼ ë§Œë“¤ì–´ì¤¬ë˜ ê²ƒì²˜ëŸ¼ ì•„ë˜ì™€ ê°™ì´ SetBufferë¥¼ í•´ì•¼í•œë‹¤.
            // offsetì´ 0ì´ ì•„ë‹Œ ê²½ìš°ë„ ìˆìŒ. -> ë²„í¼ì— í° ê°’ì„ í• ë‹¹í•´ì˜¤ê³  ì„¸ì…˜ë³„ë¡œ ìª¼ê°œì„œ ê°€ì§€ê³  ê°€ëŠ” ê²½ìš°ê°€ ìˆê¸° ë•Œë¬¸
            // í•˜ì§€ë§Œ ì§€ê¸ˆì€ ì„¸ì…˜ì„ ë§Œë“¤ë•Œë§ˆë‹¤ ë²„í¼ë¥¼ ìƒˆë¡œ ë§Œë“¤ì–´ì£¼ê¸° ë•Œë¬¸ì— offsetì€ 0ìœ¼ë¡œ í•´ë„ ëœë‹¤.
            recvArgs.SetBuffer(new byte[1024], 0, 1024); // ë²„í¼, ë²„í¼ë¥¼ ì‹œì‘í•˜ëŠ” ìœ„ì¹˜, ë²„í¼ì˜ ê¸¸ì´

            // Receive ì‹œì‘
            RegisterRecv(recvArgs);
        }

        public void Send(byte[] sendBuff)
        {
            _socket.Send(sendBuff);
        }
        // ë™ì‹œë‹¤ë°œì ìœ¼ë¡œ Disconnectë¥¼ í•˜ëŠ” ê²½ìš° 
        // Disconnectë¥¼ ê°™ì€ ì‚¬ëŒì´ 2ë²ˆ í•˜ê²Œ ëœë‹¤ë©´?
        // ì˜¤ë¥˜ê°€ ë°œìƒ
        // Disconnectë¥¼ í•œë²ˆë§Œ í•˜ë„ë¡ ì‘ì—…
        public void Disconnect()
        {
            // if (_socket != null)
            // ì´ë ‡ê²Œ _socketì´ nullì´ ì•„ë‹ ê²½ìš°ì— Closeë¥¼ í•˜ëŠ” ë°©ë²•ì€ ì •ìƒì ìœ¼ë¡œ ë™ì‘í•˜ì§€ ì•ŠëŠ”ë‹¤.
            
            // Exchange()ì˜ ë¦¬í„´ ê°’ì€ ref ê°’ì´ ë°”ë€Œê¸° ì „ì˜ ê°’ì´ë‹¤.
            // _disconnected == 1 => Disconnectê°€ ì™„ë£Œ ë˜ì—ˆë‹¤(ì´ë¯¸ refê°’ì´ 1ì´ì˜€ë‹¤).
            // ë¦¬í„´ ê°’ì´ 1ì´ë¼ë©´ ê¸°ì¡´ì— ë‹¤ë¥¸ ì“°ë ˆë“œì—ì„œ 1ë¡œ ë°”ê¿”ì¤¬ë‹¤ëŠ” ì˜ë¯¸
            // ê·¸ë˜ì„œ return
            // ì¦‰ Disconnectë¥¼ 2ë²ˆ í•˜ê²Œ ë  ë•Œ
            // ì´ë¯¸ í•œë²ˆ Disconnectê°€ ë˜ì—ˆê¸° ë•Œë¬¸ì— 
            // ë‘˜ ì¤‘ì— í•˜ë‚˜ëŠ” ifë¬¸ì— ê±¸ë ¤ì„œ ë™ì‘ì„ í•˜ì§€ ì•Šê²Œ ëœë‹¤.
            if (Interlocked.Exchange(ref _disconnected, 1) == 1)
                return;
            _socket.Shutdown(SocketShutdown.Both);
            _socket.Close();
        }

        #region ë„¤íŠ¸ì›Œí¬ í†µì‹ 

        // ë¹„ë™ê¸° ë°©ì‹ìœ¼ë¡œ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ì„œ 2ë‹¨ê³„ë¡œ ì§„í–‰ì„ í•¨
        // ë“±ë¡í•˜ëŠ” ì‘ì—…, ì™„ë£Œ í›„ ì‘ì—…
        private void RegisterRecv(SocketAsyncEventArgs args)
        {
            bool pending = _socket.ReceiveAsync(args);

            // ë°”ë¡œ ì •ë³´ë¥¼ ë°›ì•„ì˜¨ ê²½ìš°
            if (pending == false)
            {
                OnRecvComplected(null, args);
            }
            // ë§Œì•½ pendingì´ trueë©´ ìœ„ì— EventHandlerë¥¼ í†µí•´ì„œ OnRecvComplectedê°€ ìë™ìœ¼ë¡œ ì½œë°±ìœ¼ë¡œ ì‹¤í–‰ëœë‹¤.
        }
        private void OnRecvComplected(object sender, SocketAsyncEventArgs args)
        {
            // args.BytesTransferred(ì „ë‹¬ ë°›ì€ byte ê°’) ==  0ì¼ ê²½ìš°ê°€ ìˆë‹¤ => ìƒëŒ€ë°©ì´ ì ‘ì†ì„ ëŠëŠ” ê²½ìš°ì—
            // ë”°ë¼ì„œ ë°˜ë“œì‹œ 0ë³´ë‹¤ í° ê°’ì¸ì§€ë¥¼ ì²´í¬í•´ì•¼í•œë‹¤. 
            // ì†Œì¼“ ì—ëŸ¬ ë©”ì„¸ì§€ë„ ì„±ê³µì¸ì§€ í™•ì¸
            if (args.BytesTransferred > 0 && args.SocketError == SocketError.Success)
            {
                try
                {
                    // To do
                    // ë‚˜ì¤‘ì—ëŠ” íŒ¨í‚·ì„ ë¶„ì„í•˜ëŠ” ë¡œì§
                    string recvData = Encoding.UTF8.GetString(args.Buffer, args.Offset, args.BytesTransferred);
                    Console.WriteLine($"[From Client : {recvData}");

                    RegisterRecv(args);
                }
                catch (Exception e)
                {
                    Console.WriteLine($"OnRecvComplected Failed {e}");
                }

            }
            // ì‹¤íŒ¨í•œ ê²½ìš° 
            else
            {
                Disconnect();
            }
        }
        #endregion
        // ì¤‘ìš”í•œ íë¦„
        // í•œë²ˆì€ ë°›ëŠ” ë™ì‘ì´ ëë‚˜ì•¼ ë‹¤ìŒ ë“±ë¡ì´ ì§„í–‰ì´ ëœë‹¤.
        // í´ë¼ì—ì„œ ë³´ë‚¸ íŒ¨í‚·ì„ ëª¨ë‘ ë°›ê¸° ì „ê¹Œì§€ëŠ” ë”ì´ìƒ ë°›ì§€ ì•Šê² ë‹¤ëŠ” ë¡œì§
        // í•˜ì§€ë§Œ RecvëŠ” ê°„ë‹¨í•œë° SendëŠ” ê°„ë‹¨í•˜ì§€ ì•Šë‹¤.
        // ì¼ë‹¨ Recv ì˜ˆì•½ì„ ê±´ ë‹¤ìŒì— ì‹¤ì œë¡œ í´ë¼ì´ì–¸íŠ¸ê°€ ë³´ë‚¸ ë©”ì‹œì§€ë¥¼ ì²˜ë¦¬í•˜ë©´ ë˜ê¸° ë•Œë¬¸ì— ê°„ë‹¨
        // í•˜ì§€ë§Œ SendëŠ” ì˜ˆì•½ì„ í•˜ëŠ” ê²Œ ì•„ë‹ˆë¼(Recvë¥¼ ëŒ€ê¸° í•˜ëŠ” ê²Œ ì•„ë‹ˆë¼) ì›í•˜ëŠ” íƒ€ì´ë°ì— ë³´ë‚´ì•¼ í•˜ê¸° ë•Œë¬¸ì— 
        // ë§ì´ ê¹Œë‹¤ë¡­ë‹¤.
    }
}
```

```csharp
using System;
using System.Net;
using System.Net.Sockets;
using System.Text;
using System.Threading;

namespace ServerCore
{
    class ServerCoreProgram
    {
        static Listener _listener = new Listener();
        static void OnAcceptHandler(Socket clientSocket)
        {
            try
            {
                // í´ë¼ê°€ ì ‘ì†í•œ ë‹¤ìŒì— ì„¸ì…˜ì„ ìƒì„±
                Session session = new Session();
                session.Start(clientSocket);
                byte[] sendBuff = Encoding.UTF8.GetBytes("Welcome to MMORPG Server!");
                session.Send(sendBuff);

                Thread.Sleep(1000);

                session.Disconnect();
                session.Disconnect(); // ë©€í‹° ìŠ¤ë ˆë“œ í™˜ê²½ì— ëŒ€í•œ í…ŒìŠ¤íŠ¸ìš©
            }
            catch (Exception e)
            {
                Console.WriteLine(e.ToString());
            }
        }
        static void Main(string[] args)
        {
            string host = Dns.GetHostName();

            IPHostEntry ipHost = Dns.GetHostEntry(host);
            IPAddress ipAddr = ipHost.AddressList[0];
            IPEndPoint endPoint = new IPEndPoint(ipAddr, 7777);

            // ë¬¸ì§€ê¸° ë°°ì¹˜
            _listener.Init(endPoint, OnAcceptHandler);
            Console.WriteLine("Listening...");

            while (true)
            {

            }

        }
    }
}
```

**DummyClient**
```csharp
using System;
using System.Net;
using System.Net.Sockets;
using System.Text;
using System.Threading;

namespace DummyClient
{
    class Program
    {
        static void Main(string[] args)
        {
            // ì‹ë‹¹ì˜ ì£¼ì†Œë¥¼ ì°¾ëŠ” ê³¼ì •ì€ ë™ì¼í•¨
            string host = Dns.GetHostName();
            IPHostEntry ipHost = Dns.GetHostEntry(host);
            IPAddress ipAddr = ipHost.AddressList[0];
            IPEndPoint endPoint = new IPEndPoint(ipAddr, 7777);

            while(true)
            {
                // íœ´ëŒ€í° ì„¤ì •
                // ProtocolType.Tcpë¡œ ê²°ì •ì„ í•˜ë©´ SocketTypeë„ Streamìœ¼ë¡œ ìë™ìœ¼ë¡œ ê²°ì •ì´ ëœë‹¤.
                Socket socket = new Socket(endPoint.AddressFamily, SocketType.Stream, ProtocolType.Tcp);

                try
                {
                    // ë¬¸ì§€ê¸°í•œí…Œ ì…ì¥ ë¬¸ì˜ë¥¼ í•¨
                    // ìƒëŒ€ë°©ì˜ ì£¼ì†Œë¥¼ ë„£ì–´ì¤˜ì•¼í•¨
                    // ë¬¸ì§€ê¸°í•œí…Œ ì—°ë½ì´ ë‹¿ì„ ë•Œê¹Œì§€ ëŒ€ê¸°
                    socket.Connect(endPoint);

                    // ì„œë²„ì˜ ì •ë³´ë¥¼ ì¶œë ¥
                    // ì—°ê²°í•œ ëŒ€ìƒì˜ ì„œë²„ì˜ ì •ë³´
                    Console.WriteLine($"Connected to {socket.RemoteEndPoint.ToString()}"); // RemoteEndPointëŠ” ìš°ë¦¬ê°€ ì—°ê²°í•œ ë°˜ëŒ€ìª½ ëŒ€ìƒ

                    // ì„œë²„ë¡œ ë³´ë‚¸ë‹¤
                    for (int i = 0; i < 5; i++)
                    {
                        // ì„œë²„ë¡œ ë³´ë‚¼ ë°ì´í„°
                        byte[] sendBuff = Encoding.UTF8.GetBytes($"Hello World! {i}");
                        int sendByte = socket.Send(sendBuff);
                    }                    
                    
                    // ì„œë²„ë¡œë¶€í„° ë°›ëŠ”ë‹¤
                    byte[] recvBuff = new byte[1024];
                    int recvBytes = socket.Receive(recvBuff);
                    string recvData = Encoding.UTF8.GetString(recvBuff, 0, recvBytes);
                    Console.WriteLine($"[From server] {recvData}");

                    // ë‚˜ê°„ë‹¤
                    socket.Shutdown(SocketShutdown.Both);
                    socket.Close();
                }
                catch (Exception e)
                {
                    Console.WriteLine(e.ToString());
                }

                Thread.Sleep(1000); // 1ì´ˆ ëŒ€ê¸°
            }
        }
    }
}
```